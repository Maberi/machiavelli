{% extends "machiavelli/base.html" %}

{% load i18n %}
{% load game_icons %}
{% load stars %}

{% block head_title %}{{ game.slug }}{% endblock %}

{% block left_column %}
<h1>{{ game.slug }}</h1>
<p>{% blocktrans %}This game has not started, because is has not yet enough players.{% endblocktrans %}</p>

<div class="game_info {% if game.fast %}fast{% endif %}">
<h2><span><a href="{{ game.get_absolute_url }}">{{ game.slug }}</a></span>
	<span>
		({% trans "Slots" %}: {{ game.slots }})
	</span>
	{% if game.private %}
	<span>{% trans "Private" %}</span>
	{% endif %}
	</h2>
<div class="map">
<img src="{{ MEDIA_URL }}maps/thumbnails/scenario-{{ game.scenario.pk }}.jpg" />
</div>
<dl>
<dt>{% trans "Average score" %}</dt><dd>{{ game.get_average_score|score_stars }}</dd>
<dt>{% trans "Average karma" %}</dt><dd>{{ game.get_average_karma|karma_stars }}</dd>
<dt>{% trans "Scenario" %}</dt><dd><a href="{% url show-scenario game.scenario.pk %}">{{ game.scenario.title }}</a></dd>
<dt>{% trans "Cities to win" %}</dt><dd>{{ game.cities_to_win }}</dd>
<dt>{% trans "Time limit" %}</dt><dd>{{ game.get_time_limit_display }}</dd>
<dt>{% trans "Creator" %}</dt><dd>{{ game.created_by.username }}</dd>
<dt>{% trans "Players" %}</dt>
<dd>
	{% if game.visible %}
	<ul>
	{% for p in game.player_set.all %}
		{% if p.user %}
		<li><a href="{% url profile_detail username=p.user.username %}">{{ p.user.username }}</a></li>
		{% endif %}
	{% endfor %}
	</ul>
	{% else %}
	{% trans "Players are not visible" %}
	{% endif %}
</dd>
{% if game.private %}
<dt>{% trans "Invited users" %}</dt>
<dd>{{ game.invitation_set.all|join:", " }}</dd>
{% endif %}
{% if game.comment %}
<dt>{% trans "Comment" %}</dt>
<dd>{{ game.comment }}</dd>
{% endif %}
</dl>
<ul class="section_menu">
	<li>{% rule_icons game.configuration %}</li>
	{% if game.private %}
		{% ifequal game.created_by user %}
			<li><a href="{% url invite-users game.slug %}">{% trans "Invitations" %}</a></li>
			<li><a href="{% url make-public game.slug %}">{% trans "Make public" %}</a></li>
		{% endifequal %}
	{% endif %}
	<li><a href="{% url show-game game.slug %}">{% trans "View game" %}</a></li>
	{% if joinable %}
	<li><a href="{% url join-game game.slug %}">{% trans "Join game" %}</a></li>
	{% else %}
	<li><a href="{% url leave-game game.slug %}">{% trans "Leave game" %}</a></li>
	{% endif %}
</ul>
</div>

{% endblock %}
